import{a4 as k,a8 as xe,r as ne,j as e,C as g,c as j,d as v,e as b,B as q,L as ue,g as he}from"./index-Dt07UTka.js";import{O as se}from"./ObserverLayout-CvoqjA9a.js";import{B as ie}from"./badge-BL2mfjTD.js";import{b as Fe,c as Be,u as ye}from"./isEqual-XG_EwNFo.js";import{f as Ie,g as Re,E as Ke,h as re,i as X,j as Me,k as $e,l as H,m as le,n as ze,o as Ve,p as Ne,q as We,G as qe,r as pe,s as He,X as B,Y as I,t as Ue,u as we,R as T,T as F,B as oe,a as Q,D as fe,C as ge,b as Je,c as Y,d as Ge,P as Xe,e as Ye,L as Qe,A as Ze}from"./AreaChart-Bn4MLSv8.js";import{f as ke}from"./fr-CfdXjsD4.js";import{T as Z}from"./target-ATEbl8ER.js";import{B as Ae}from"./briefcase-DGZDCsL0.js";import{U as ee}from"./users-BSixSwM-.js";import{C as Ce}from"./calendar-BKvS43I6.js";import{T as Pe}from"./trending-up-B44pE4Wv.js";import{C as ce}from"./chart-column-Cqu8Sd2N.js";import{E as Oe}from"./eye-BrJFRD8F.js";import{f as Se,B as et}from"./formatDistanceToNow-2oA28mCp.js";import"./brain-BM1gby9g.js";import"./user-ix4zyo1H.js";import"./log-out-C2CngwNs.js";import"./useQuery-BeOx6H6z.js";import"./useMutation-DLLhhcgk.js";import"./dialog-DETbZ713.js";import"./index-CnKgKWfo.js";import"./Combination-aU0zapuW.js";import"./index-lOYlu7e4.js";import"./index-BdQq_4o_.js";import"./format-BbOC2X4i.js";import"./en-US-Dy1UnLtf.js";import"./layout-dashboard-CftRPHET.js";import"./endOfMonth-CkNiGKnp.js";var tt=["type","layout","connectNulls","ref"],at=["key"];function R(t){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},R(t)}function je(t,a){if(t==null)return{};var r=st(t,a),s,l;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(l=0;l<n.length;l++)s=n[l],!(a.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function st(t,a){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(a.indexOf(s)>=0)continue;r[s]=t[s]}return r}function U(){return U=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},U.apply(this,arguments)}function ve(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),r.push.apply(r,s)}return r}function C(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?ve(Object(r),!0).forEach(function(s){P(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function L(t){return lt(t)||it(t)||nt(t)||rt()}function rt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nt(t,a){if(t){if(typeof t=="string")return de(t,a);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return de(t,a)}}function it(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lt(t){if(Array.isArray(t))return de(t)}function de(t,a){(a==null||a>t.length)&&(a=t.length);for(var r=0,s=new Array(a);r<a;r++)s[r]=t[r];return s}function ot(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function be(t,a){for(var r=0;r<a.length;r++){var s=a[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,De(s.key),s)}}function ct(t,a,r){return a&&be(t.prototype,a),r&&be(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dt(t,a,r){return a=te(a),mt(t,_e()?Reflect.construct(a,r||[],te(t).constructor):a.apply(t,r))}function mt(t,a){if(a&&(R(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xt(t)}function xt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_e=function(){return!!t})()}function te(t){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},te(t)}function ut(t,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(a&&a.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),a&&me(t,a)}function me(t,a){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},me(t,a)}function P(t,a,r){return a=De(a),a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function De(t){var a=ht(t,"string");return R(a)=="symbol"?a:a+""}function ht(t,a){if(R(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(R(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var K=function(t){function a(){var r;ot(this,a);for(var s=arguments.length,l=new Array(s),n=0;n<s;n++)l[n]=arguments[n];return r=dt(this,a,[].concat(l)),P(r,"state",{isAnimationFinished:!0,totalLength:0}),P(r,"generateSimpleStrokeDasharray",function(i,d){return"".concat(d,"px ").concat(i-d,"px")}),P(r,"getStrokeDasharray",function(i,d,m){var h=m.reduce(function(N,f){return N+f});if(!h)return r.generateSimpleStrokeDasharray(d,i);for(var y=Math.floor(i/h),p=i%h,u=d-i,o=[],c=0,x=0;c<m.length;x+=m[c],++c)if(x+m[c]>p){o=[].concat(L(m.slice(0,c)),[p-x]);break}var w=o.length%2===0?[0,u]:[u];return[].concat(L(a.repeat(m,y)),L(o),w).map(function(N){return"".concat(N,"px")}).join(", ")}),P(r,"id",We("recharts-line-")),P(r,"pathRef",function(i){r.mainCurve=i}),P(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),P(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return ut(a,t),ct(a,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();this.setState({totalLength:s})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();s!==this.state.totalLength&&this.setState({totalLength:s})}}},{key:"getTotalLength",value:function(){var s=this.mainCurve;try{return s&&s.getTotalLength&&s.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(s,l){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var n=this.props,i=n.points,d=n.xAxis,m=n.yAxis,h=n.layout,y=n.children,p=Re(y,Ke);if(!p)return null;var u=function(x,w){return{x:x.x,y:x.y,value:x.value,errorVal:Ne(x.payload,w)}},o={clipPath:s?"url(#clipPath-".concat(l,")"):null};return k.createElement(re,o,p.map(function(c){return k.cloneElement(c,{key:"bar-".concat(c.props.dataKey),data:i,xAxis:d,yAxis:m,layout:h,dataPointFormatter:u})}))}},{key:"renderDots",value:function(s,l,n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var d=this.props,m=d.dot,h=d.points,y=d.dataKey,p=X(this.props,!1),u=X(m,!0),o=h.map(function(x,w){var N=C(C(C({key:"dot-".concat(w),r:3},p),u),{},{index:w,cx:x.x,cy:x.y,value:x.value,dataKey:y,payload:x.payload,points:h});return a.renderDotItem(m,N)}),c={clipPath:s?"url(#clipPath-".concat(l?"":"dots-").concat(n,")"):null};return k.createElement(re,U({className:"recharts-line-dots",key:"dots"},c),o)}},{key:"renderCurveStatically",value:function(s,l,n,i){var d=this.props,m=d.type,h=d.layout,y=d.connectNulls;d.ref;var p=je(d,tt),u=C(C(C({},X(p,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(n,")"):null,points:s},i),{},{type:m,layout:h,connectNulls:y});return k.createElement(Me,U({},u,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(s,l){var n=this,i=this.props,d=i.points,m=i.strokeDasharray,h=i.isAnimationActive,y=i.animationBegin,p=i.animationDuration,u=i.animationEasing,o=i.animationId,c=i.animateNewValues,x=i.width,w=i.height,N=this.state,f=N.prevPoints,S=N.totalLength;return k.createElement($e,{begin:y,duration:p,isActive:h,easing:u,from:{t:0},to:{t:1},key:"line-".concat(o),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var O=D.t;if(f){var M=f.length/d.length,_=d.map(function(A,ae){var V=Math.floor(ae*M);if(f[V]){var W=f[V],E=H(W.x,A.x),Ee=H(W.y,A.y);return C(C({},A),{},{x:E(O),y:Ee(O)})}if(c){var Le=H(x*2,A.x),Te=H(w/2,A.y);return C(C({},A),{},{x:Le(O),y:Te(O)})}return C(C({},A),{},{x:A.x,y:A.y})});return n.renderCurveStatically(_,s,l)}var J=H(0,S),$=J(O),z;if(m){var G="".concat(m).split(/[,\s]+/gim).map(function(A){return parseFloat(A)});z=n.getStrokeDasharray($,S,G)}else z=n.generateSimpleStrokeDasharray(S,$);return n.renderCurveStatically(d,s,l,{strokeDasharray:z})})}},{key:"renderCurve",value:function(s,l){var n=this.props,i=n.points,d=n.isAnimationActive,m=this.state,h=m.prevPoints,y=m.totalLength;return d&&i&&i.length&&(!h&&y>0||!Be(h,i))?this.renderCurveWithAnimation(s,l):this.renderCurveStatically(i,s,l)}},{key:"render",value:function(){var s,l=this.props,n=l.hide,i=l.dot,d=l.points,m=l.className,h=l.xAxis,y=l.yAxis,p=l.top,u=l.left,o=l.width,c=l.height,x=l.isAnimationActive,w=l.id;if(n||!d||!d.length)return null;var N=this.state.isAnimationFinished,f=d.length===1,S=xe("recharts-line",m),D=h&&h.allowDataOverflow,O=y&&y.allowDataOverflow,M=D||O,_=le(w)?this.id:w,J=(s=X(i,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},$=J.r,z=$===void 0?3:$,G=J.strokeWidth,A=G===void 0?2:G,ae=ze(i)?i:{},V=ae.clipDot,W=V===void 0?!0:V,E=z*2+A;return k.createElement(re,{className:S},D||O?k.createElement("defs",null,k.createElement("clipPath",{id:"clipPath-".concat(_)},k.createElement("rect",{x:D?u:u-o/2,y:O?p:p-c/2,width:D?o:o*2,height:O?c:c*2})),!W&&k.createElement("clipPath",{id:"clipPath-dots-".concat(_)},k.createElement("rect",{x:u-E/2,y:p-E/2,width:o+E,height:c+E}))):null,!f&&this.renderCurve(M,_),this.renderErrorBar(M,_),(f||i)&&this.renderDots(M,W,_),(!x||N)&&Ve.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(s,l){return s.animationId!==l.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:l.curPoints}:s.points!==l.curPoints?{curPoints:s.points}:null}},{key:"repeat",value:function(s,l){for(var n=s.length%2!==0?[].concat(L(s),[0]):s,i=[],d=0;d<l;++d)i=[].concat(L(i),L(n));return i}},{key:"renderDotItem",value:function(s,l){var n;if(k.isValidElement(s))n=k.cloneElement(s,l);else if(Fe(s))n=s(l);else{var i=l.key,d=je(l,at),m=xe("recharts-line-dot",typeof s!="boolean"?s.className:"");n=k.createElement(Ie,U({key:i},d,{className:m}))}return n}}])}(ne.PureComponent);P(K,"displayName","Line");P(K,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!qe.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});P(K,"getComposedData",function(t){var a=t.props,r=t.xAxis,s=t.yAxis,l=t.xAxisTicks,n=t.yAxisTicks,i=t.dataKey,d=t.bandSize,m=t.displayedData,h=t.offset,y=a.layout,p=m.map(function(u,o){var c=Ne(u,i);return y==="horizontal"?{x:pe({axis:r,ticks:l,bandSize:d,entry:u,index:o}),y:le(c)?null:s.scale(c),value:c,payload:u}:{x:le(c)?null:r.scale(c),y:pe({axis:s,ticks:n,bandSize:d,entry:u,index:o}),value:c,payload:u}});return C({points:p,layout:y},h)});var pt=He({chartName:"LineChart",GraphicalChild:K,axisComponents:[{axisType:"xAxis",AxisComp:B},{axisType:"yAxis",AxisComp:I}],formatAxisMap:Ue});function ft(){const{stats:t,jobCoverage:a,statusEvolution:r,isLoading:s}=ye(),{data:l}=we();return s?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Chargement des données avancées..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Dashboard Avancé - Mode Observateur"}),e.jsx("p",{className:"text-muted-foreground",children:"Analyse approfondie des données de recrutement (lecture seule)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(g,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Taux de Conversion"}),e.jsx(Z,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:[t.totalCandidates>0?Math.round(t.interviewsScheduled/t.totalCandidates*100):0,"%"]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Candidats → Entretiens"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Efficacité des Offres"}),e.jsx(Ae,{className:"h-4 w-4 text-green-600 dark:text-green-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:[a.length>0?Math.round(a.filter(n=>n.current_applications>=5).length/a.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Offres performantes"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Diversité Genre"}),e.jsx(ee,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:[Math.abs((t.femalePercent??0)-(t.malePercent??0)),"%"]}),e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:"Écart de diversité"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Activité 24h"}),e.jsx(Ce,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-900 dark:text-orange-100",children:t.newCandidates}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"Nouvelles candidatures"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(j,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5"}),"Évolution des candidatures (7 jours)"]})}),e.jsx(b,{children:e.jsx("div",{className:"h-64",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(pt,{data:r,children:[e.jsx(B,{dataKey:"date",tickFormatter:n=>new Date(n).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})}),e.jsx(I,{}),e.jsx(F,{labelFormatter:n=>new Date(n).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx(K,{type:"monotone",dataKey:"candidature",stroke:"#EC4899",strokeWidth:2,name:"Candidatures"}),e.jsx(K,{type:"monotone",dataKey:"incubation",stroke:"#f59e0b",strokeWidth:2,name:"Incubation"})]})})})})]}),e.jsxs(g,{children:[e.jsx(j,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Répartition par statut"]})}),e.jsx(b,{children:e.jsx("div",{className:"h-64",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(oe,{data:[{name:"Candidature",value:r.reduce((n,i)=>n+i.candidature,0),fill:"#EC4899"},{name:"Incubation",value:r.reduce((n,i)=>n+i.incubation,0),fill:"#f59e0b"},{name:"Embauche",value:r.reduce((n,i)=>n+i.embauche,0),fill:"#10b981"},{name:"Refusé",value:r.reduce((n,i)=>n+i.refuse,0),fill:"#ef4444"}],children:[e.jsx(B,{dataKey:"name"}),e.jsx(I,{}),e.jsx(F,{}),e.jsx(Q,{dataKey:"value",radius:[4,4,0,0]})]})})})})]})]}),e.jsxs(g,{children:[e.jsx(j,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Activités Récentes Détaillées"]})}),e.jsx(b,{children:e.jsx("div",{className:"space-y-4",children:l&&l.slice(0,10).map((n,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ie,{variant:"outline",className:"text-xs",children:["#",i+1]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[n.description," pour ",e.jsx("span",{className:"text-primary",children:n.job_title})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Se(new Date(n.created_at),{addSuffix:!0,locale:ke})})]})]}),e.jsx(ie,{variant:"secondary",className:"text-xs",children:"Observateur"})]},n.id))})})]}),e.jsxs(g,{className:"bg-muted/50",children:[e.jsx(j,{children:e.jsx(v,{className:"text-lg",children:"Mode Observateur"})}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Fonctionnalités disponibles :"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Visualisation de toutes les données"}),e.jsx("li",{children:"• Analyse des statistiques"}),e.jsx("li",{children:"• Consultation des graphiques"}),e.jsx("li",{children:"• Suivi des activités"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Fonctionnalités désactivées :"}),e.jsxs("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Modification des offres"}),e.jsx("li",{children:"• Évaluation des candidats"}),e.jsx("li",{children:"• Ajout de commentaires"}),e.jsx("li",{children:"• Changement de statuts"})]})]})]})})]})]})}function qt(){const{stats:t,jobCoverage:a,statusEvolution:r,applicationsPerJob:s,isLoading:l,error:n}=ye(),{data:i,isLoading:d,error:m}=we(),[h,y]=ne.useState(!1),[p,u]=ne.useState("classic");return p==="advanced"?e.jsx(se,{children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8",children:[e.jsx(fe,{currentView:p,onToggle:u}),e.jsx(ft,{})]})}):n?e.jsx(se,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-red-500 mb-4",children:["Erreur lors du chargement: ",n]}),e.jsx(q,{variant:"outline",onClick:()=>window.location.reload(),children:"Réessayer"})]})})}):e.jsx(se,{children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8",children:[e.jsx(fe,{currentView:p,onToggle:u}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground mb-2",children:"Tableau de Bord Observateur"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Visualisez les Offres d'emploi et suivez les candidatures en temps réel"})]})}),l?e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center py-8 sm:py-12 gap-2",children:[e.jsx(ue,{className:"w-6 h-6 sm:w-8 sm:w-8 animate-spin text-primary"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Chargement du dashboard..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs(g,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-blue-200 dark:border-blue-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-blue-700 dark:text-blue-300",children:"Offres"}),e.jsx(Ae,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600 dark:text-blue-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-900 dark:text-blue-100",children:t.totalJobs}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Actives"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-green-200 dark:border-green-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-green-700 dark:text-green-300",children:"Total des candidats"}),e.jsx(ee,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600 dark:text-green-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-900 dark:text-green-100",children:t.totalCandidates}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Candidats uniques"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-950 dark:to-emerald-900 border-emerald-200 dark:border-emerald-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-emerald-700 dark:text-emerald-300",children:"Total des candidatures"}),e.jsx(ce,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-600 dark:text-emerald-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-emerald-900 dark:text-emerald-100",children:a.reduce((o,c)=>o+c.current_applications,0)}),e.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 mt-1",children:["+",t.newCandidates," ce jour"]})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-purple-200 dark:border-purple-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-purple-700 dark:text-purple-300",children:"Candidatures par poste"}),e.jsx(Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-purple-600 dark:text-purple-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-purple-900 dark:text-purple-100",children:t.totalJobs>0?Math.round(a.reduce((o,c)=>o+c.current_applications,0)/t.totalJobs):0}),e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:"Moyenne"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mt-3 sm:mt-4",children:[e.jsxs(g,{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900 border-orange-200 dark:border-orange-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-orange-700 dark:text-orange-300",children:"Candidats multi-postes"}),e.jsx(ee,{className:"h-4 w-4 sm:h-5 sm:w-5 text-orange-600 dark:text-orange-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-900 dark:text-orange-100",children:t.multiPostCandidates??0}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"Candidats"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-950 dark:to-cyan-900 border-cyan-200 dark:border-cyan-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-cyan-700 dark:text-cyan-300",children:"Taux de couverture"}),e.jsx(Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-cyan-600 dark:text-cyan-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-cyan-900 dark:text-cyan-100",children:[a.length>0?Math.round(a.filter(o=>o.current_applications>0).length/a.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-cyan-600 dark:text-cyan-400 mt-1",children:"Postes avec candidats"})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-950 dark:to-indigo-900 border-indigo-200 dark:border-indigo-800",children:[e.jsx(j,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{className:"text-xs sm:text-sm font-medium text-indigo-700 dark:text-indigo-300",children:"Entretiens"}),e.jsx(Ce,{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-600 dark:text-indigo-400"})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-indigo-900 dark:text-indigo-100",children:t.interviewsScheduled}),e.jsx("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-1",children:"Planifiés"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mt-6 sm:mt-8",children:[e.jsxs(g,{children:[e.jsxs(j,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),e.jsx(v,{className:"text-base sm:text-lg",children:"Attractivité des candidatures"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Basé sur le nombre de candidatures reçues - 2 offres par catégorie"})]}),e.jsxs(b,{children:[e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(oe,{data:(()=>{const o=a.filter(N=>N.coverage_status==="excellent").slice(0,2),c=a.filter(N=>N.coverage_status==="good").slice(0,2),x=a.filter(N=>N.coverage_status==="moderate").slice(0,2),w=a.filter(N=>N.coverage_status==="low").slice(0,2);return[...o,...c,...x,...w]})(),margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(B,{dataKey:"title",tick:{fontSize:10},interval:0,height:60,angle:-45,textAnchor:"end"}),e.jsx(I,{tick:{fontSize:12}}),e.jsx(F,{formatter:(o,c)=>[o,"Nombre de candidatures"],labelFormatter:o=>{const c=a.find(x=>x.title===o);return`${o} (${c==null?void 0:c.current_applications} candidatures)`}}),e.jsx(Q,{dataKey:"current_applications",radius:[4,4,0,0],name:"Nombre de candidatures",children:(()=>{const o=a.filter(f=>f.coverage_status==="excellent").slice(0,2),c=a.filter(f=>f.coverage_status==="good").slice(0,2),x=a.filter(f=>f.coverage_status==="moderate").slice(0,2),w=a.filter(f=>f.coverage_status==="low").slice(0,2);return[...o,...c,...x,...w].map((f,S)=>e.jsx(ge,{fill:f.coverage_status==="excellent"?"#10b981":f.coverage_status==="good"?"#3b82f6":f.coverage_status==="moderate"?"#f59e0b":"#ef4444"},`cell-${S}`))})()})]})})}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{children:"Excellent (≥10 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"Bon (7-9 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{children:"Modéré (4-6 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"Faible (1-3 candidatures)"})]})]})]})]}),e.jsxs(g,{children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-primary"}),e.jsx(v,{className:"text-base sm:text-lg",children:"Dynamique des candidatures par offre"})]})}),e.jsx(b,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(oe,{data:s.slice(0,8),margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(B,{dataKey:"title",tick:{fontSize:10},interval:0,height:60,angle:-45,textAnchor:"end"}),e.jsx(I,{tick:{fontSize:12}}),e.jsx(F,{}),e.jsx(Q,{dataKey:"applications_count",fill:"#8B5CF6",radius:[4,4,0,0],name:"Total candidatures"}),e.jsx(Q,{dataKey:"new_applications_24h",fill:"#EC4899",radius:[4,4,0,0],name:"Nouvelles (24h)"})]})})})})]}),e.jsxs(g,{children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-primary"}),e.jsx(v,{className:"text-base sm:text-lg",children:"Évolution des statuts par jour"})]})}),e.jsx(b,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(Je,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(B,{dataKey:"date",tick:{fontSize:12},tickFormatter:o=>new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})}),e.jsx(I,{tick:{fontSize:12}}),e.jsx(F,{labelFormatter:o=>new Date(o).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx(Y,{type:"monotone",dataKey:"candidature",stackId:"1",stroke:"#EC4899",fill:"#EC4899",fillOpacity:.6,name:"Candidature"}),e.jsx(Y,{type:"monotone",dataKey:"incubation",stackId:"1",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6,name:"Incubation"}),e.jsx(Y,{type:"monotone",dataKey:"embauche",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Embauche"}),e.jsx(Y,{type:"monotone",dataKey:"refuse",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Refusé"})]})})})})]}),e.jsxs(g,{children:[e.jsxs(j,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5 text-primary"}),e.jsx(v,{className:"text-base sm:text-lg",children:"Répartition par genre"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Distribution des candidats par genre"})]}),e.jsx(b,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(T,{width:"100%",height:"100%",children:e.jsxs(Xe,{children:[e.jsx(Ye,{data:[{name:"Femmes",value:t.femalePercent??0,fill:"#ec4899",candidates:Math.round((t.femalePercent??0)*(t.totalCandidates??0)/100)},{name:"Hommes",value:t.malePercent??0,fill:"#3b82f6",candidates:Math.round((t.malePercent??0)*(t.totalCandidates??0)/100)}],cx:"50%",cy:"50%",outerRadius:80,innerRadius:40,paddingAngle:5,dataKey:"value",children:[{name:"Femmes",value:t.femalePercent??0,fill:"#ec4899"},{name:"Hommes",value:t.malePercent??0,fill:"#3b82f6"}].map((o,c)=>e.jsx(ge,{fill:o.fill},`cell-${c}`))}),e.jsx(F,{formatter:(o,c,x)=>[`${o.toFixed(1)}% (${x.payload.candidates} candidats)`,c],contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px",padding:"8px"}}),e.jsx(Qe,{verticalAlign:"bottom",height:36,formatter:(o,c)=>{const x=Math.round(c.payload.value*(t.totalCandidates??0)/100);return e.jsxs("span",{style:{color:c.color,fontSize:"14px"},children:[o," (",c.payload.value.toFixed(1),"% - ",x," candidats)"]})}})]})})})})]})]}),e.jsxs("div",{className:"mt-8 sm:mt-12 grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(g,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsx(j,{children:e.jsx(v,{className:"text-base sm:text-lg",children:"Navigation"})}),e.jsxs(b,{className:"space-y-3",children:[e.jsx(he,{to:"/observer/candidates",className:"block",children:e.jsxs(q,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(ee,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Voir tous les candidats"]})}),e.jsx(he,{to:"/jobs",className:"block",children:e.jsxs(q,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(Oe,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Espace candidature"]})})]})]}),e.jsxs(g,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsxs(j,{className:"flex flex-row items-center justify-between",children:[e.jsx(v,{className:"text-base sm:text-lg",children:"Activité récente"}),e.jsx(q,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground",children:e.jsx(et,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),e.jsx(b,{children:d?e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(ue,{className:"w-5 h-5 sm:w-6 sm:w-6 animate-spin text-primary"})}):m?e.jsx("p",{className:"text-red-500 text-xs sm:text-sm",children:"Erreur de chargement des activités"}):i&&i.length>0?e.jsxs("div",{className:"space-y-3 text-xs sm:text-sm",children:[i.map(o=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2",children:[e.jsxs("span",{className:"truncate pr-2 min-w-0",title:`${o.description} pour ${o.job_title}`,children:[o.description," pour ",e.jsx("strong",{className:"font-medium",children:o.job_title})]}),e.jsx(ie,{variant:"outline",className:"text-xs flex-shrink-0 self-start sm:self-center",children:Se(new Date(o.created_at),{addSuffix:!0,locale:ke})})]},o.id)),e.jsx("div",{className:"pt-2",children:e.jsx(q,{variant:"link",className:"p-0 h-auto text-xs sm:text-sm",onClick:()=>y(!0),children:"Voir tout l'historique"})})]}):e.jsx("p",{className:"text-muted-foreground text-xs sm:text-sm text-center py-4",children:"Aucune activité récente."})})]})]})]}),e.jsx(Ze,{isOpen:h,onClose:()=>y(!1)})]})})}export{qt as default};
