import{r as p,a as D,j as e,g as C,B as h,L as w,C as _,e as E}from"./index-Dt07UTka.js";import{R as S}from"./RecruiterLayout-CzqFpArC.js";import{I as L}from"./input-Bw9vQiwZ.js";import{B as y}from"./badge-BL2mfjTD.js";import{D as T,a as A,b as P,c as k,d as R,e as z}from"./dialog-DETbZ713.js";import{L as l}from"./label-5-3zOpNH.js";import{e as B}from"./useApplications-Dtoeuj7w.js";import{a as F,g as G,f as I,D as U}from"./useDocuments-BoCfcbm3.js";import{S as O}from"./search-CrW7gRAG.js";import{U as v}from"./user-ix4zyo1H.js";import{C as M}from"./calendar-BKvS43I6.js";import{E as $}from"./eye-BrJFRD8F.js";import{F as q}from"./file-text-XdKEpMSd.js";import{f as H}from"./format-BbOC2X4i.js";import{f as V}from"./fr-CfdXjsD4.js";import"./sidebar-DQHe9abK.js";import"./separator-CPOmk9ej.js";import"./index-CnKgKWfo.js";import"./Combination-aU0zapuW.js";import"./layout-dashboard-CftRPHET.js";import"./users-BSixSwM-.js";import"./brain-BM1gby9g.js";import"./briefcase-DGZDCsL0.js";import"./log-out-C2CngwNs.js";import"./useQuery-BeOx6H6z.js";import"./useMutation-DLLhhcgk.js";import"./en-US-Dy1UnLtf.js";function J({candidate:r,isObserver:g}){var m,i;const{data:n=[],isLoading:d,error:a}=F(r.id),u=o=>o;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Nom complet"}),e.jsxs("p",{className:"font-medium",children:[r.firstName," ",r.lastName]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:r.email})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Téléphone"}),e.jsx("p",{className:"font-medium",children:r.phone||"Non fourni"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Sexe"}),e.jsx("p",{className:"font-medium",children:r.gender||"Non renseigné"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Date de naissance"}),e.jsx("p",{className:"font-medium",children:r.birthDate?H(new Date(r.birthDate),"PPP",{locale:V}):"Non renseignée"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Poste postulé"}),e.jsx("p",{className:"font-medium",children:r.jobTitle||"Non spécifié"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Statut:"}),e.jsx(y,{variant:"secondary",className:((m=x[r.status])==null?void 0:m.color)||"bg-gray-100 text-gray-800 border-gray-200",children:((i=x[r.status])==null?void 0:i.label)||"Inconnu"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Poste actuel"}),e.jsx("p",{className:"font-medium",children:r.currentPosition||"Non renseigné"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx(l,{className:"text-sm text-muted-foreground",children:"Documents fournis"})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(w,{className:"w-4 h-4 animate-spin"})," Chargement des documents..."]}),a&&e.jsxs("div",{className:"text-sm text-red-600",children:["Erreur de chargement: ",a.message]}),!d&&!a&&(n.length>0?e.jsx("ul",{className:"space-y-2",children:n.map(o=>e.jsxs("li",{className:"flex items-center justify-between rounded border p-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium truncate",children:[G(o.document_type)," — ",o.file_name]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:I(o.file_size)})]}),e.jsxs("a",{href:u(o.file_url),target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-primary hover:underline",children:[e.jsx(U,{className:"w-4 h-4"}),"Ouvrir"]})]},o.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun document fourni."}))]})]})}const x={candidature:{label:"Candidat",color:"bg-blue-100 text-blue-800 border-blue-200"},incubation:{label:"Incubé",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},embauche:{label:"Engagé",color:"bg-green-100 text-green-800 border-green-200"},refuse:{label:"Refusé",color:"bg-red-100 text-red-800 border-red-200"},entretien_programme:{label:"Entretien-Programmé",color:"bg-purple-100 text-purple-800 border-purple-200"}};function ve(){const[r,g]=p.useState(""),[n,d]=p.useState("all"),{applications:a,isLoading:u,error:m}=B(),{isObserver:i}=D();console.log("[CANDIDATES PAGE DEBUG] Applications hook result:",{applications:a,isLoading:u,error:m}),console.log("[CANDIDATES PAGE DEBUG] Applications count:",a==null?void 0:a.length),p.useEffect(()=>{},[]);const b=p.useMemo(()=>(a||[]).map(s=>{var f,j;const t=s.users||{},c=(t==null?void 0:t.candidate_profiles)||{},N=s.status&&x[s.status]?s.status:"candidature";return{id:s.id,firstName:t.first_name||"",lastName:t.last_name||"",email:t.email||"",phone:t.phone||void 0,gender:t.gender||c.gender||void 0,birthDate:t.date_of_birth||c.birth_date||void 0,currentPosition:c.current_position||t.current_position||void 0,location:((f=s.job_offers)==null?void 0:f.location)||void 0,appliedDate:s.created_at,status:N,jobTitle:((j=s.job_offers)==null?void 0:j.title)||void 0,linkedin_url:c.linkedin_url||t.linkedin_url||void 0,portfolio_url:c.portfolio_url||t.portfolio_url||void 0}}),[a]).filter(s=>{const t=r.toLowerCase(),c=`${s.firstName} ${s.lastName}`.toLowerCase(),N=(s.jobTitle||"").toLowerCase(),f=c.includes(t)||s.email.toLowerCase().includes(t)||N.includes(t),j=n==="all"||s.status===n;return f&&j});return e.jsx(S,{children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 py-6 sm:py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground mb-2",children:"Toutes les Candidatures"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Gérez et suivez tous les candidats qui ont postulé aux offres SEEG."})]}),e.jsx(C,{to:"/recruiter",children:e.jsx(h,{variant:"outline",className:"text-sm sm:text-base w-full sm:w-auto",children:"Retour au tableau de bord"})})]}),u&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(w,{className:"w-6 h-6 animate-spin mr-2"}),"Chargement des candidats..."]}),m&&e.jsxs("div",{className:"text-center py-6 text-red-600",children:["Erreur lors du chargement: ",m.message]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-3 w-4 h-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Rechercher par nom, email ou poste...",value:r,onChange:s=>g(s.target.value),className:"pl-10 text-sm sm:text-base"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(h,{variant:n==="all"?"default":"outline",size:"sm",onClick:()=>d("all"),className:"text-xs sm:text-sm",children:"Tous"}),Object.entries(x).map(([s,t])=>e.jsx(h,{variant:n===s?"default":"outline",size:"sm",onClick:()=>d(s),className:"text-xs sm:text-sm",children:t.label},s))]})]}),e.jsx(_,{children:e.jsx(E,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b bg-muted/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Candidat"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Poste"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Statut"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Date"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Actions"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-dark/10 rounded-full flex items-center justify-center",children:e.jsx(v,{className:"w-5 h-5 text-primary-dark"})}),e.jsx("div",{children:e.jsxs("div",{className:"font-medium text-foreground",children:[s.firstName," ",s.lastName]})})]})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"text-sm font-medium text-foreground",children:s.jobTitle||"-"})}),e.jsx("td",{className:"p-4",children:e.jsx(y,{variant:"secondary",className:x[s.status].color,children:x[s.status].label})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.appliedDate).toLocaleDateString("fr-FR")})]})}),e.jsx("td",{className:"p-4",children:e.jsxs(T,{children:[e.jsx(A,{asChild:!0,children:e.jsxs(h,{variant:"outline",size:"sm",className:`gap-2 ${i?"opacity-50 cursor-not-allowed":""}`,disabled:i,title:i?"Lecture seule - Mode observateur":"Voir les détails",children:[e.jsx($,{className:"w-4 h-4"}),"Détails"]})}),e.jsxs(P,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(k,{children:[e.jsx(R,{children:"Détails du candidat"}),e.jsx(z,{children:i?e.jsx("span",{className:"text-yellow-600",children:"Mode observateur - Lecture seule"}):"Consulter les informations détaillées du candidat et les documents soumis."})]}),e.jsx(J,{candidate:s,isObserver:i})]})]})})]},s.id))})]})})})}),b.length===0&&!u&&!m&&e.jsxs("div",{className:"text-center py-8 sm:py-12",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:e.jsx(v,{className:"w-6 h-6 sm:w-8 sm:h-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-base sm:text-lg font-medium text-foreground mb-2",children:"Aucun candidat trouvé"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-4 sm:mb-6",children:"Aucun candidat ne correspond à vos critères de recherche."}),e.jsx(h,{variant:"outline",onClick:()=>{g(""),d("all")},className:"text-xs sm:text-sm",children:"Réinitialiser les filtres"})]})]})})}export{ve as default};
