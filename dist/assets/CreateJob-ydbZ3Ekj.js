import{u as S,k as L,r as q,j as e,g as F,B as m,A as I,C as T,c as E,d as J,e as M,L as j}from"./index-Dt07UTka.js";import{R}from"./RecruiterLayout-CzqFpArC.js";import{I as o}from"./input-Bw9vQiwZ.js";import{L as i}from"./label-5-3zOpNH.js";import{S as d,a as u,b as x,c as p,d as r}from"./select-B2MghH9c.js";import{R as b}from"./quill.snow-CAKySR-3.js";import{a as O}from"./isEqual-XG_EwNFo.js";import{S as P}from"./save-Dp_vy41W.js";import{S as k}from"./send-ekdqg9ff.js";import"./sidebar-DQHe9abK.js";import"./separator-CPOmk9ej.js";import"./index-CnKgKWfo.js";import"./Combination-aU0zapuW.js";import"./layout-dashboard-CftRPHET.js";import"./users-BSixSwM-.js";import"./brain-BM1gby9g.js";import"./briefcase-DGZDCsL0.js";import"./user-ix4zyo1H.js";import"./log-out-C2CngwNs.js";import"./index-Cr6IkeUt.js";import"./index-BdQq_4o_.js";import"./index-lOYlu7e4.js";import"./index-CUAMUldx.js";import"./useQuery-BeOx6H6z.js";import"./useMutation-DLLhhcgk.js";function me(){const f=S(),{toast:c}=L(),{createJobOffer:N,isCreating:l}=O(),[s,C]=q.useState({title:"",reportingLine:"",contractType:"",categorieMetier:"",salaryNote:"",startDate:"",location:"",dateLimite:"",responsibilities:"",requirements:""}),a=(t,g)=>{C({...s,[t]:g})},y=async()=>{await h("draft")},D=async()=>{await h("published")},h=async t=>{if(console.log("[CreateJob] Starting submission with status:",t),console.log("[CreateJob] Form data:",s),!s.title||!s.location||!s.contractType||!s.responsibilities||!s.requirements){c({title:"Champs requis",description:"Veuillez remplir tous les champs obligatoires avant de continuer.",variant:"destructive"});return}if(!["CDI avec période d'essai","CDI","CDD","Stage","Freelance"].includes(s.contractType)){c({title:"Type de contrat invalide",description:"Le type de contrat doit être CDI avec période d'essai, CDI, CDD, Stage ou Freelance.",variant:"destructive"});return}const w=t==="published"?"active":"draft",v={title:s.title,location:s.location,contract_type:s.contractType,description:s.responsibilities,profile:s.requirements,categorie_metier:s.categorieMetier||null,date_limite:s.dateLimite?new Date(s.dateLimite).toISOString():null,reporting_line:s.reportingLine||null,salary_note:s.salaryNote||null,start_date:s.startDate||null};console.log("[CreateJob] Prepared job data:",v);try{const n=await N({jobData:v,status:w});console.log("[CreateJob] Creation successful:",n),c({title:"Offre d'emploi sauvegardée",description:`L'offre a été ${t==="published"?"publiée":"sauvegardée comme brouillon"} avec succès.`,variant:"default"}),f("/recruiter")}catch(n){console.error("[CreateJob] Creation failed:",n),c({title:"Erreur lors de la sauvegarde",description:n instanceof Error?n.message:"Une erreur est survenue. Veuillez réessayer.",variant:"destructive"})}};return e.jsx(R,{children:e.jsx("div",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex items-start sm:items-center gap-3 sm:gap-4 min-w-0",children:[e.jsx(F,{to:"/recruiter",children:e.jsx(m,{variant:"outline",size:"icon",className:"flex-shrink-0",children:e.jsx(I,{className:"w-3 h-3 sm:w-4 sm:h-4"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground",children:"Créer une nouvelle offre"}),e.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-muted-foreground",children:"Remplissez les informations pour attirer les meilleurs talents"})]})]})}),e.jsxs(T,{className:"shadow-medium",children:[e.jsx(E,{children:e.jsx(J,{className:"text-base sm:text-lg lg:text-xl",children:"Informations de l'offre"})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:t=>t.preventDefault(),className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"title",className:"text-sm sm:text-base font-medium",children:"Intitulé du poste *"}),e.jsx(o,{id:"title",value:s.title,onChange:t=>a("title",t.target.value),placeholder:"Ex: Développeur Full-Stack",className:"text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"reportingLine",className:"text-sm sm:text-base font-medium",children:"Ligne hiérarchique directe"}),e.jsx(o,{id:"reportingLine",value:s.reportingLine,onChange:t=>a("reportingLine",t.target.value),placeholder:"Ex: Chef de Département Support",className:"text-sm sm:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"contractType",className:"text-sm sm:text-base font-medium",children:"Type de contrat *"}),e.jsxs(d,{value:s.contractType,onValueChange:t=>a("contractType",t),required:!0,children:[e.jsx(u,{className:"text-sm sm:text-base",children:e.jsx(x,{placeholder:"Type de contrat"})}),e.jsxs(p,{children:[e.jsx(r,{value:"CDI avec période d'essai",children:"CDI avec période d'essai"}),e.jsx(r,{value:"CDI",children:"CDI "}),e.jsx(r,{value:"CDD",children:"CDD "})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"categorieMetier",className:"text-sm sm:text-base font-medium",children:"Catégorie *"}),e.jsxs(d,{value:s.categorieMetier,onValueChange:t=>a("categorieMetier",t),required:!0,children:[e.jsx(u,{className:"text-sm sm:text-base",children:e.jsx(x,{placeholder:"Choisir une catégorie"})}),e.jsxs(p,{children:[e.jsx(r,{value:"Cadre",children:"Cadre"}),e.jsx(r,{value:"Cadre directeur",children:"Cadre de Direction "})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"salaryNote",className:"text-sm sm:text-base font-medium",children:"Salaire brut"}),e.jsx(o,{id:"salaryNote",value:s.salaryNote,onChange:t=>a("salaryNote",t.target.value),placeholder:"Ex: Selon grille salariale SEEG",className:"text-sm sm:text-base"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"startDate",className:"text-sm sm:text-base font-medium",children:"Date d'embauche"}),e.jsx(o,{id:"startDate",type:"date",value:s.startDate,onChange:t=>a("startDate",t.target.value),className:"text-sm sm:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"location",className:"text-sm sm:text-base font-medium",children:"Lieu de travail *"}),e.jsxs(d,{value:s.location,onValueChange:t=>a("location",t),required:!0,children:[e.jsx(u,{className:"text-sm sm:text-base",children:e.jsx(x,{placeholder:"Choisir une ville"})}),e.jsxs(p,{children:[e.jsx(r,{value:"Libreville",children:"Libreville"}),e.jsx(r,{value:"Port-Gentil",children:"Port-Gentil"}),e.jsx(r,{value:"Franceville",children:"Franceville"}),e.jsx(r,{value:"Oyem",children:"Oyem"}),e.jsx(r,{value:"Moanda",children:"Moanda"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"dateLimite",className:"text-sm sm:text-base font-medium",children:"Date limite de candidature"}),e.jsx(o,{id:"dateLimite",type:"date",value:s.dateLimite,onChange:t=>a("dateLimite",t.target.value),min:new Date().toISOString().split("T")[0],className:"text-sm sm:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"responsibilities",className:"text-sm sm:text-base font-medium",children:"Missions principales *"}),e.jsx(b,{theme:"snow",value:s.responsibilities,onChange:t=>a("responsibilities",t),placeholder:`Saisissez une mission par ligne
Ex:
- Définir et piloter la politique RH
- Élaborer et superviser la gestion administrative du personnel`,className:"bg-card quill-editor-container"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"requirements",className:"text-sm sm:text-base font-medium",children:"Connaissance savoir et requis *"}),e.jsx(b,{theme:"snow",value:s.requirements,onChange:t=>a("requirements",t),placeholder:`Saisissez un requis par ligne
Ex:
- Bac+5 en RH, Droit social, Psychologie du travail
- Expérience managériale de X années`,className:"bg-card quill-editor-container"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end pt-6 border-t gap-3 sm:gap-2",children:[e.jsxs(m,{variant:"outline",onClick:y,disabled:l||!s.title||!s.location||!s.contractType||!s.responsibilities||!s.requirements,className:"w-full sm:w-auto text-xs sm:text-sm",children:[l?e.jsx(j,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 animate-spin"}):e.jsx(P,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),l?"Sauvegarde...":"Sauvegarder le brouillon"]}),e.jsxs(m,{variant:"success",onClick:D,disabled:l||!s.title||!s.location||!s.contractType||!s.responsibilities||!s.requirements,className:"w-full sm:w-auto text-xs sm:text-sm",children:[l?e.jsx(j,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 animate-spin"}):e.jsx(k,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),l?"Publication...":"Publier l'offre"]})]})]})})]})]})})})}export{me as default};
