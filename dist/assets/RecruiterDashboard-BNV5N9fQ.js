import{r as y,s as me,u as ee,a as se,j as e,B as m,L,C as n,c as l,d as c,e as d,g as A}from"./index-Dt07UTka.js";import{R as O}from"./RecruiterLayout-CzqFpArC.js";import{B as te}from"./badge-BL2mfjTD.js";import{u as ae}from"./isEqual-XG_EwNFo.js";import{u as re,A as ie,D as U,R as F,B as W,X as K,Y as I,T as P,a as H,C as B,b as xe,c as D,d as X,P as Y,e as G,L as Q}from"./AreaChart-Bn4MLSv8.js";import{f as ne}from"./fr-CfdXjsD4.js";import{P as q}from"./plus-Cq7fvgYR.js";import{U as T}from"./users-BSixSwM-.js";import{E as le}from"./eye-BrJFRD8F.js";import{B as ce,f as de}from"./formatDistanceToNow-2oA28mCp.js";import{B as he}from"./briefcase-DGZDCsL0.js";import{T as V}from"./target-ATEbl8ER.js";import{C as Z}from"./chart-column-Cqu8Sd2N.js";import{C as ue}from"./calendar-BKvS43I6.js";import{T as pe}from"./trending-up-B44pE4Wv.js";import"./sidebar-DQHe9abK.js";import"./input-Bw9vQiwZ.js";import"./separator-CPOmk9ej.js";import"./index-CnKgKWfo.js";import"./Combination-aU0zapuW.js";import"./layout-dashboard-CftRPHET.js";import"./brain-BM1gby9g.js";import"./user-ix4zyo1H.js";import"./log-out-C2CngwNs.js";import"./useQuery-BeOx6H6z.js";import"./useMutation-DLLhhcgk.js";import"./dialog-DETbZ713.js";import"./index-lOYlu7e4.js";import"./index-BdQq_4o_.js";import"./format-BbOC2X4i.js";import"./en-US-Dy1UnLtf.js";import"./endOfMonth-CkNiGKnp.js";function je(r){const[x,_]=y.useState(null),[b,p]=y.useState(!1),[S,k]=y.useState(null),C=h=>{const f=(h||"").toLowerCase();return["applied","pending","new","nouveau"].includes(f)?"applied":["interview","incubation","entretien","scheduled"].includes(f)?"interview":["offer","offre","offered","hired","embauche"].includes(f)?"offer":["rejected","refused","refuse","rejeté","rejetee"].includes(f)?"rejected":"applied"},v=y.useCallback(async()=>{if(r!==0){p(!0),k(null);try{const{data:h,error:f}=await me.rpc("get_all_recruiter_applications");if(f)throw f;if(h){const E=h.map(i=>{var o;return{created_at:i.application_details.created_at,status:C(i.application_details.status),position:((o=i.job_offer_details)==null?void 0:o.title)||"Poste inconnu"}}),g=new Map,N=new Map,s=new Map;E.forEach(i=>{const o=i.position,$=i.status,z=new Date(i.created_at).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"});g.has(o)||g.set(o,{count:0,target:1}),g.get(o).count++,N.set($,(N.get($)||0)+1),s.has(z)||s.set(z,{applied:0,interview:0,offer:0,rejected:0});const R=s.get(z);switch($){case"applied":R.applied++;break;case"interview":R.interview++;break;case"offer":R.offer++;break;case"rejected":R.rejected++;break;default:R.applied++}});const t=E.length,a=r,w=Array.from(g.keys()).length,u=a>0?Math.round(w/a*100):0,M=Array.from(g.entries()).map(([i,o])=>({position:i,count:o.count,target:o.target})).sort((i,o)=>o.count-i.count),oe=Array.from(s.entries()).map(([i,o])=>({month:i,...o})),J=[{status:"Candidatures",count:N.get("applied")||0,percentage:0,color:"#3B82F6"},{status:"Entretiens",count:N.get("interview")||0,percentage:0,color:"#10B981"},{status:"Offres",count:N.get("offer")||0,percentage:0,color:"#F59E0B"},{status:"Rejetées",count:N.get("rejected")||0,percentage:0,color:"#EF4444"}];J.forEach(i=>{i.percentage=t>0?Math.round(i.count/t*100):0}),_({totalApplications:t,coverageRate:u,openPositions:a,applicationsByPosition:M,statusEvolution:oe,applicationsByStatus:J})}}catch(h){console.error("Erreur lors du chargement des statistiques avancées:",h),k(h instanceof Error?h.message:"Erreur inconnue")}finally{p(!1)}}},[r]);return y.useEffect(()=>{v()},[v]),{stats:x,isLoading:b,error:S,refetch:()=>{v()}}}function fe(){ee();const{activeJobs:r,isLoading:x,error:_}=ae();je(r.length);const{data:b,isLoading:p,error:S}=re(),{isRecruiter:k}=se(),[C,v]=y.useState(!1);return _?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("p",{className:"text-sm sm:text-base text-red-500 mb-4",children:["Erreur lors du chargement: ",_]}),e.jsx(m,{variant:"outline",onClick:()=>window.location.reload(),className:"text-sm sm:text-base",children:"Réessayer"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground mb-2",children:"Traitement préléminaire avec l'IA embarquée"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Analyse IA des candidatures"})]})}),x?e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center py-8 sm:py-12 gap-2",children:[e.jsx(L,{className:"w-6 h-6 sm:w-8 sm:w-8 animate-spin text-primary"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Chargement du dashboard..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(n,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsx(l,{children:e.jsx(c,{className:"text-base sm:text-lg",children:"Actions rapides"})}),e.jsxs(d,{className:"space-y-3",children:[k&&e.jsx(A,{to:"/recruiter/jobs/new",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(q,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Créer une nouvelle offre"]})}),e.jsx(A,{to:"/recruiter/candidates",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(T,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Voir tous les candidats"]})}),e.jsx(A,{to:"/jobs",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(le,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Espace candidature"]})})]})]}),e.jsxs(n,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between",children:[e.jsx(c,{className:"text-base sm:text-lg",children:"Activité récente"}),e.jsx(m,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground",children:e.jsx(ce,{className:"h-4 w-4 sm:h-5 sm:h-5"})})]}),e.jsx(d,{children:p?e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 animate-spin text-primary"})}):S?e.jsx("p",{className:"text-red-500 text-xs sm:text-sm",children:"Erreur de chargement des activités"}):b&&b.length>0?e.jsxs("div",{className:"space-y-3 text-xs sm:text-sm",children:[b.map(j=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2",children:[e.jsxs("span",{className:"truncate pr-2 min-w-0",title:`${j.description} pour ${j.job_title}`,children:[j.description," pour ",e.jsx("strong",{className:"font-medium",children:j.job_title})]}),e.jsx(te,{variant:"outline",className:"text-xs flex-shrink-0 self-start sm:self-center",children:de(new Date(j.created_at),{addSuffix:!0,locale:ne})})]},j.id)),e.jsx("div",{className:"pt-2",children:e.jsx(m,{variant:"link",className:"p-0 h-auto text-xs sm:text-sm",onClick:()=>v(!0),children:"Voir tout l'historique"})})]}):e.jsx("p",{className:"text-muted-foreground text-xs sm:text-sm text-center py-4",children:"Aucune activité récente."})})]})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Données en temps réel alimentées par Supabase"})}),e.jsx(ie,{isOpen:C,onClose:()=>v(!1)})]})}function Ge(){ee();const{stats:r,jobCoverage:x,statusEvolution:_,applicationsPerJob:b,departmentStats:p,isLoading:S,error:k}=ae(),{data:C,isLoading:v,error:j}=re(),{isRecruiter:h}=se(),[f,E]=y.useState(!1),[g,N]=y.useState("classic");return g==="advanced"?e.jsx(O,{children:e.jsxs("div",{className:"container mx-auto px-2 sm:px-4 lg:px-6 py-2 sm:py-4 lg:py-6",children:[e.jsx(U,{currentView:g,onToggle:N}),e.jsx(fe,{})]})}):k?e.jsx(O,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-red-500 mb-4",children:["Erreur lors du chargement: ",k]}),e.jsx(m,{variant:"outline",onClick:()=>window.location.reload(),children:"Réessayer"})]})})}):e.jsx(O,{children:e.jsxs("div",{className:"container mx-auto px-2 sm:px-4 lg:px-6 py-2 sm:py-4 lg:py-6",children:[e.jsx(U,{currentView:g,onToggle:N}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground mb-2",children:"Tableau de Bord"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Gérez vos Offres d'emploi et suivez vos candidatures en temps réel"})]}),h&&e.jsx(A,{to:"/recruiter/jobs/new",children:e.jsxs(m,{variant:"hero",className:"gap-2 w-full sm:w-auto",children:[e.jsx(q,{className:"w-4 h-4"}),"Nouvelle offre"]})})]}),S?e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center py-8 sm:py-12 gap-2",children:[e.jsx(L,{className:"w-6 h-6 sm:w-8 sm:w-8 animate-spin text-primary"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Chargement du dashboard..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs(n,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-blue-200 dark:border-blue-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-blue-700 dark:text-blue-300",children:"Offres"}),e.jsx(he,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600 dark:text-blue-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-900 dark:text-blue-100",children:r.totalJobs}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Actives"})]})]}),e.jsxs(n,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-green-200 dark:border-green-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-cyan-700 dark:text-cyan-300",children:"Taux de couverture"}),e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5 text-cyan-600 dark:text-cyan-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-cyan-900 dark:text-cyan-100",children:[x.length>0?Math.round(x.filter(s=>s.current_applications>0).length/x.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-cyan-600 dark:text-cyan-400 mt-1",children:"Postes avec candidats"})]})]}),e.jsxs(n,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-950 dark:to-emerald-900 border-emerald-200 dark:border-emerald-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-green-700 dark:text-green-300",children:"Total des candidats"}),e.jsx(T,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600 dark:text-green-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-900 dark:text-green-100",children:r.totalCandidates}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Candidats uniques"})]})]}),e.jsxs(n,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-purple-200 dark:border-purple-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-emerald-700 dark:text-emerald-300",children:"Total des candidatures"}),e.jsx(Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-600 dark:text-emerald-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-emerald-900 dark:text-emerald-100",children:x.reduce((s,t)=>s+t.current_applications,0)}),e.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 mt-1",children:["+",r.newCandidates," Dernières 24h"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mt-3 sm:mt-4",children:[e.jsxs(n,{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-950 dark:to-cyan-900 border-cyan-200 dark:border-cyan-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-cyan-700 dark:text-cyan-300",children:"Répartition par type de métier"}),e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5 text-cyan-600 dark:text-cyan-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs font-medium text-cyan-700 dark:text-cyan-300 mb-2",children:[e.jsx("div",{children:"Type"}),e.jsx("div",{className:"text-center",children:"Postes"}),e.jsx("div",{className:"text-center",children:"Candidatures"}),e.jsx("div",{className:"text-center",children:"%"})]}),e.jsx("div",{className:"space-y-2",children:p.map(s=>{const t=p.reduce((w,u)=>w+u.applicationCount,0),a=t>0?Math.round(s.applicationCount/t*100):0;return e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.department==="Électricité"?"bg-orange-500":s.department==="Eau"?"bg-blue-500":"bg-gray-600"}`}),e.jsx("span",{className:"text-cyan-700 dark:text-cyan-300 font-medium",children:s.department})]}),e.jsx("div",{className:"text-center text-cyan-900 dark:text-cyan-100 font-bold",children:s.jobCount}),e.jsx("div",{className:"text-center text-cyan-900 dark:text-cyan-100 font-bold",children:s.applicationCount}),e.jsxs("div",{className:"text-center text-cyan-900 dark:text-cyan-100 font-bold",children:[a,"%"]})]},s.department)})})]})]}),e.jsxs(n,{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900 border-orange-200 dark:border-orange-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-orange-700 dark:text-orange-300",children:"Candidats multi-postes"}),e.jsx(T,{className:"h-4 w-4 sm:h-5 sm:w-5 text-orange-600 dark:text-orange-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-900 dark:text-orange-100",children:r.multiPostCandidates??0}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"Candidats"})]})]}),e.jsxs(n,{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-950 dark:to-indigo-900 border-indigo-200 dark:border-indigo-800",children:[e.jsx(l,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-xs sm:text-sm font-medium text-indigo-700 dark:text-indigo-300",children:"Entretiens"}),e.jsx(ue,{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-600 dark:text-indigo-400"})]})}),e.jsxs(d,{className:"pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-indigo-900 dark:text-indigo-100",children:r.interviewsScheduled}),e.jsx("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-1",children:"Planifiés"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mt-6 sm:mt-8",children:[e.jsxs(n,{children:[e.jsxs(l,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-primary"}),e.jsx(c,{className:"text-base sm:text-lg",children:"Attractivité des postes"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Basé sur le nombre de candidatures reçues"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"h-72 sm:h-96",children:e.jsx(F,{width:"106%",height:"100%",children:e.jsxs(W,{data:[...x].sort((t,a)=>a.current_applications-t.current_applications),margin:{top:10,right:10,left:10,bottom:10},children:[e.jsx(K,{dataKey:"title",tick:{fontSize:window.innerWidth<768?7:10},interval:0,height:60,angle:-45,textAnchor:"end"}),e.jsx(I,{tick:{fontSize:10}}),e.jsx(P,{formatter:(s,t)=>[s,"Nombre de candidatures"],labelFormatter:s=>(x.find(t=>t.title===s),`${s}`)}),e.jsx(H,{dataKey:"current_applications",radius:[4,4,0,0],name:"Nombre de candidatures",children:[...x].sort((t,a)=>a.current_applications-t.current_applications).map((t,a)=>e.jsx(B,{fill:t.coverage_status==="excellent"?"#10b981":t.coverage_status==="good"?"#3b82f6":t.coverage_status==="moderate"?"#f59e0b":"#ef4444"},`cell-${a}`))})]})})}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{children:"Forte (≥10 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"Bonne (7-9 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{children:"Modérée (4-6 candidatures)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"Faible (1-3 candidatures)"})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(l,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),e.jsx(c,{className:"text-base sm:text-lg",children:"Dynamique des candidatures par offre"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total des candidatures et dernières 24h"})]}),e.jsx(d,{children:e.jsx("div",{className:"h-72 sm:h-96",children:e.jsx(F,{width:"106%",height:"100%",children:e.jsxs(W,{data:[...b].sort((t,a)=>a.applications_count-t.applications_count),margin:{top:10,right:10,left:10,bottom:10},children:[e.jsx(K,{dataKey:"title",tick:{fontSize:window.innerWidth<768?7:10},interval:0,height:60,angle:-45,textAnchor:"end"}),e.jsx(I,{tick:{fontSize:12}}),e.jsx(P,{formatter:(s,t)=>[s,t==="applications_count"?"Total candidatures":"Nouvelles (24h)"],labelFormatter:s=>{b.find(a=>a.title===s);const t=x.find(a=>a.title===s);return t!=null&&t.coverage_status,`${s}`}}),e.jsx(H,{dataKey:"applications_count",fill:"#8B5CF6",radius:[4,4,0,0],name:"Total candidatures"}),e.jsx(H,{dataKey:"new_applications_24h",fill:"#EC4899",radius:[4,4,0,0],name:"Nouvelles (24h)"})]})})})})]}),e.jsxs(n,{children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5 text-primary"}),e.jsx(c,{className:"text-base sm:text-lg",children:"Évolution des statuts par jour"})]})}),e.jsx(d,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(F,{width:"100%",height:"100%",children:e.jsxs(xe,{data:_,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(K,{dataKey:"date",tick:{fontSize:12},tickFormatter:s=>{const[t,a,w]=s.split("-");return`${w}/${a}`}}),e.jsx(I,{tick:{fontSize:12}}),e.jsx(P,{labelFormatter:s=>new Date(s).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx(D,{type:"monotone",dataKey:"candidature",stackId:"1",stroke:"#EC4899",fill:"#EC4899",fillOpacity:.6,name:"Candidature"}),e.jsx(D,{type:"monotone",dataKey:"incubation",stackId:"1",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6,name:"Incubation"}),e.jsx(D,{type:"monotone",dataKey:"embauche",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Embauche"}),e.jsx(D,{type:"monotone",dataKey:"refuse",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Refusé"})]})})})})]}),e.jsxs(n,{children:[e.jsxs(l,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),e.jsx(c,{className:"text-base sm:text-lg",children:"Répartition par type de métier"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Distribution des candidatures par type de poste"})]}),e.jsx(d,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(F,{width:"100%",height:"100%",children:e.jsxs(Y,{children:[e.jsxs(G,{data:(()=>{var w;const s=p.filter(u=>u.department==="Eau"||u.department==="Électricité").reduce((u,M)=>u+M.applicationCount,0),t=((w=p.find(u=>u.department==="Support"))==null?void 0:w.applicationCount)||0,a=s+t;return[{name:"Métier ",value:s,percentage:a>0?s/a*100:0,fill:"#3b82f6"},{name:"Support",value:t,percentage:a>0?t/a*100:0,fill:"#6b7280"}]})(),cx:"50%",cy:"50%",outerRadius:80,innerRadius:40,paddingAngle:5,dataKey:"value",children:[e.jsx(B,{fill:"#3b82f6"}),e.jsx(B,{fill:"#6b7280"})]}),e.jsx(P,{formatter:(s,t,a)=>[`${s} candidatures (${a.payload.percentage.toFixed(1)}%)`,t],contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px",padding:"8px"}}),e.jsx(Q,{verticalAlign:"bottom",height:36,formatter:(s,t)=>{const a=t.payload;return e.jsxs("span",{style:{color:t.color,fontSize:"14px"},children:[s," (",a.value," candidatures - ",a.percentage.toFixed(1),"%)"]})}})]})})})})]}),e.jsxs(n,{children:[e.jsxs(l,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),e.jsx(c,{className:"text-base sm:text-lg",children:"Répartition par genre"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Distribution des candidats par genre"})]}),e.jsx(d,{children:e.jsx("div",{className:"h-64 sm:h-80",children:e.jsx(F,{width:"100%",height:"100%",children:e.jsxs(Y,{children:[e.jsx(G,{data:[{name:"Femmes",value:r.femalePercent??0,fill:"#ec4899",candidates:Math.round((r.femalePercent??0)*(r.totalCandidates??0)/100)},{name:"Hommes",value:r.malePercent??0,fill:"#3b82f6",candidates:Math.round((r.malePercent??0)*(r.totalCandidates??0)/100)}],cx:"50%",cy:"50%",outerRadius:80,innerRadius:40,paddingAngle:5,dataKey:"value",children:[{name:"Femmes",value:r.femalePercent??0,fill:"#ec4899"},{name:"Hommes",value:r.malePercent??0,fill:"#3b82f6"}].map((s,t)=>e.jsx(B,{fill:s.fill},`cell-${t}`))}),e.jsx(P,{formatter:(s,t,a)=>[`${s.toFixed(1)}% (${a.payload.candidates} candidats)`,t],contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px",padding:"8px"}}),e.jsx(Q,{verticalAlign:"bottom",height:36,formatter:(s,t)=>{const a=Math.round(t.payload.value*(r.totalCandidates??0)/100);return e.jsxs("span",{style:{color:t.color,fontSize:"14px"},children:[s," (",t.payload.value.toFixed(1),"% - ",a," candidats)"]})}})]})})})})]})]}),e.jsxs("div",{className:"mt-8 sm:mt-12 grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(n,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsx(l,{children:e.jsx(c,{className:"text-base sm:text-lg",children:"Actions rapides"})}),e.jsxs(d,{className:"space-y-3",children:[h&&e.jsx(A,{to:"/recruiter/jobs/new",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(q,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Créer une nouvelle offre"]})}),e.jsx(A,{to:"/recruiter/candidates",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(T,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Voir tous les candidats"]})}),e.jsx(A,{to:"/jobs",className:"block",children:e.jsxs(m,{variant:"outline",className:"w-full justify-start gap-2 text-xs sm:text-sm",children:[e.jsx(le,{className:"w-3 h-3 sm:w-4 sm:w-4"}),"Espace candidature"]})})]})]}),e.jsxs(n,{className:"shadow-soft hover:shadow-medium transition-all",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between",children:[e.jsx(c,{className:"text-base sm:text-lg",children:"Activité récente"}),e.jsx(m,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground",children:e.jsx(ce,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),e.jsx(d,{children:v?e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:w-6 animate-spin text-primary"})}):j?e.jsx("p",{className:"text-red-500 text-xs sm:text-sm",children:"Erreur de chargement des activités"}):C&&C.length>0?e.jsxs("div",{className:"space-y-3 text-xs sm:text-sm",children:[C.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2",children:[e.jsxs("span",{className:"truncate pr-2 min-w-0",title:`${s.description} pour ${s.job_title}`,children:[s.description," pour ",e.jsx("strong",{className:"font-medium",children:s.job_title})]}),e.jsx(te,{variant:"outline",className:"text-xs flex-shrink-0 self-start sm:self-center",children:de(new Date(s.created_at),{addSuffix:!0,locale:ne})})]},s.id)),e.jsx("div",{className:"pt-2",children:e.jsx(m,{variant:"link",className:"p-0 h-auto text-xs sm:text-sm",onClick:()=>E(!0),children:"Voir tout l'historique"})})]}):e.jsx("p",{className:"text-muted-foreground text-xs sm:text-sm text-center py-4",children:"Aucune activité récente."})})]})]})]}),e.jsx(ie,{isOpen:f,onClose:()=>E(!1)})]})})}export{Ge as default};
