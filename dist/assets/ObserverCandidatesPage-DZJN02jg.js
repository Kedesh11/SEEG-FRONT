import{h as H,r as c,j as e,B as f,L as U,C as W,e as $}from"./index-Dt07UTka.js";import{O as F}from"./ObserverLayout-CvoqjA9a.js";import{I as J}from"./input-Bw9vQiwZ.js";import{B as K}from"./badge-BL2mfjTD.js";import{D as Q,a as X,b as Y,c as Z,d as ee,e as se}from"./dialog-DETbZ713.js";import{L as l}from"./label-5-3zOpNH.js";import{S as re,a as te,b as le,c as ae,d as h}from"./select-B2MghH9c.js";import{e as ie}from"./useApplications-Dtoeuj7w.js";import{a as ne,g as oe,f as ce,D as me}from"./useDocuments-BoCfcbm3.js";import{S as de}from"./search-CrW7gRAG.js";import{F as ue}from"./filter-nUhWB70p.js";import{M as xe}from"./mail-DxVkVQXW.js";import{P as he}from"./phone-Bri8K_yJ.js";import{B as R}from"./briefcase-DGZDCsL0.js";import{C as fe}from"./calendar-BKvS43I6.js";import{E as N}from"./eye-BrJFRD8F.js";import{F as pe}from"./file-text-XdKEpMSd.js";import{f as v}from"./format-BbOC2X4i.js";import{f as b}from"./fr-CfdXjsD4.js";import"./chart-column-Cqu8Sd2N.js";import"./users-BSixSwM-.js";import"./brain-BM1gby9g.js";import"./user-ix4zyo1H.js";import"./log-out-C2CngwNs.js";import"./index-CnKgKWfo.js";import"./Combination-aU0zapuW.js";import"./index-Cr6IkeUt.js";import"./index-BdQq_4o_.js";import"./index-lOYlu7e4.js";import"./index-CUAMUldx.js";import"./useQuery-BeOx6H6z.js";import"./useMutation-DLLhhcgk.js";import"./en-US-Dy1UnLtf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=H("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function je({candidate:r,isOpen:j,onClose:a}){console.log("[CANDIDATE MODAL DEBUG] Opening modal for candidate:",r),console.log("[CANDIDATE MODAL DEBUG] Using applicationId:",r.id);const{data:i,isLoading:m,error:d}=ne(r.id);console.log("[CANDIDATE MODAL DEBUG] Documents from hook:",i);const u=t=>t;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Nom complet"}),e.jsxs("p",{className:"font-medium",children:[r.firstName," ",r.lastName]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:r.email})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Téléphone"}),e.jsx("p",{className:"font-medium",children:r.phone||"Non fourni"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Sexe"}),e.jsx("p",{className:"font-medium",children:r.gender||"Non renseigné"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Date de naissance"}),e.jsx("p",{className:"font-medium",children:r.birthDate?v(new Date(r.birthDate),"PPP",{locale:b}):"Non renseignée"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Poste actuel"}),e.jsx("p",{className:"font-medium",children:r.currentPosition||"Non renseigné"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Localisation"}),e.jsx("p",{className:"font-medium",children:r.location||"Non renseignée"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Poste candidaté"}),e.jsx("p",{className:"font-medium",children:r.jobTitle||"Non renseigné"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Date de candidature"}),e.jsx("p",{className:"font-medium",children:v(new Date(r.appliedDate),"PPP",{locale:b})})]})]}),(r.linkedin_url||r.portfolio_url)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Liens externes"}),e.jsxs("div",{className:"flex gap-2",children:[r.linkedin_url&&e.jsxs("a",{href:r.linkedin_url.startsWith("http")?r.linkedin_url:`https://${r.linkedin_url}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors",children:[e.jsx(V,{className:"w-4 h-4"}),"LinkedIn"]}),r.portfolio_url&&e.jsxs("a",{href:r.portfolio_url.startsWith("http")?r.portfolio_url:`https://${r.portfolio_url}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 text-sm bg-purple-50 text-purple-700 rounded-md hover:bg-purple-100 transition-colors",children:[e.jsx(V,{className:"w-4 h-4"}),"Portfolio"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{className:"text-sm text-muted-foreground",children:"Documents de candidature"}),m?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(U,{className:"w-4 h-4 animate-spin"}),"Chargement des documents..."]}):d?e.jsx("p",{className:"text-sm text-red-500",children:"Erreur lors du chargement des documents"}):i&&i.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:i.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:t.file_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[oe(t.document_type||"")," • ",ce(t.file_size)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>window.open(u(t.file_url),"_blank"),children:e.jsx(N,{className:"w-4 h-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{const n=document.createElement("a");n.href=u(t.file_url),n.download=t.file_name,n.click()},children:e.jsx(me,{className:"w-4 h-4"})})]})]},String(t.id)))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun document disponible"})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(N,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"Mode Observateur"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Vous êtes en mode observateur. Vous pouvez consulter toutes les informations des candidats mais vous ne pouvez pas modifier leur statut, ajouter des commentaires ou effectuer des évaluations."})]})]})})]})}function Xe(){const[r,j]=c.useState(""),[a,i]=c.useState("all"),[m,d]=c.useState(null),[u,t]=c.useState(!1),{applications:n,isLoading:w,error:C}=ie(),D=c.useMemo(()=>n?n.map(s=>{var o,p,x,_,y,L,k,S,E,A,M,P,T,O,I,B,z;return{id:s.id,firstName:((o=s.users)==null?void 0:o.first_name)||"N/A",lastName:((p=s.users)==null?void 0:p.last_name)||"N/A",email:((x=s.users)==null?void 0:x.email)||"N/A",phone:(_=s.users)==null?void 0:_.phone,gender:((y=s.users)==null?void 0:y.sexe)||((L=s.users)==null?void 0:L.gender),birthDate:(S=(k=s.users)==null?void 0:k.candidate_profiles)==null?void 0:S.birth_date,currentPosition:(A=(E=s.users)==null?void 0:E.candidate_profiles)==null?void 0:A.current_position,location:(P=(M=s.users)==null?void 0:M.candidate_profiles)==null?void 0:P.address,appliedDate:s.created_at,status:s.status||"candidature",jobTitle:(T=s.job_offers)==null?void 0:T.title,linkedin_url:(I=(O=s.users)==null?void 0:O.candidate_profiles)==null?void 0:I.linkedin_url,portfolio_url:(z=(B=s.users)==null?void 0:B.candidate_profiles)==null?void 0:z.portfolio_url}}):[],[n]),g=c.useMemo(()=>D.filter(s=>{var x;const o=s.firstName.toLowerCase().includes(r.toLowerCase())||s.lastName.toLowerCase().includes(r.toLowerCase())||s.email.toLowerCase().includes(r.toLowerCase())||((x=s.jobTitle)==null?void 0:x.toLowerCase().includes(r.toLowerCase())),p=a==="all"||s.status===a;return o&&p}),[D,r,a]),q=s=>{switch(s){case"candidature":return"default";case"incubation":return"secondary";case"embauche":return"success";case"refuse":return"destructive";default:return"default"}},G=s=>{switch(s){case"candidature":return"Candidature";case"incubation":return"En incubation";case"embauche":return"Embauché";case"refuse":return"Refusé";default:return s}};return C?e.jsx(F,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-red-500 mb-4",children:["Erreur lors du chargement: ",C.message]}),e.jsx(f,{variant:"outline",onClick:()=>window.location.reload(),children:"Réessayer"})]})})}):e.jsx(F,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Candidats - Mode Observateur"}),e.jsx("p",{className:"text-muted-foreground",children:"Consultez la liste des candidats et leurs informations (lecture seule)"})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(J,{placeholder:"Rechercher par nom, email ou poste...",value:r,onChange:s=>j(s.target.value),className:"pl-10"})]})}),e.jsxs(re,{value:a,onValueChange:s=>i(s),children:[e.jsx(te,{className:"w-full sm:w-48",children:e.jsx(le,{placeholder:"Filtrer par statut"})}),e.jsxs(ae,{children:[e.jsx(h,{value:"all",children:"Tous les statuts"}),e.jsx(h,{value:"candidature",children:"Candidature"}),e.jsx(h,{value:"incubation",children:"En incubation"}),e.jsx(h,{value:"embauche",children:"Embauché"}),e.jsx(h,{value:"refuse",children:"Refusé"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsxs("span",{children:[g.length," candidat(s) trouvé(s)"]})]})]}),w?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(U,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsx("div",{className:"grid gap-4",children:g.map(s=>e.jsx(W,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s.firstName," ",s.lastName]}),e.jsx(K,{variant:q(s.status),children:G(s.status)})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s.phone})]}),s.currentPosition&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s.currentPosition})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:v(new Date(s.appliedDate),"dd/MM/yyyy",{locale:b})})]})]}),s.jobTitle&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsxs("span",{children:["Poste candidaté : ",s.jobTitle]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(Q,{open:u&&(m==null?void 0:m.id)===s.id,onOpenChange:o=>{o?(d(s),t(!0)):(t(!1),d(null))},children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Voir détails"]})}),e.jsxs(Y,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Détails du candidat"}),e.jsxs(se,{children:["Informations complètes de ",s.firstName," ",s.lastName]})]}),e.jsx(je,{candidate:s,isOpen:u,onClose:()=>{t(!1),d(null)}})]})]})})]})})},s.id))}),!w&&g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-muted-foreground mb-4",children:r||a!=="all"?"Aucun candidat ne correspond aux critères de recherche":"Aucun candidat trouvé"}),(r||a!=="all")&&e.jsx(f,{variant:"outline",onClick:()=>{j(""),i("all")},children:"Réinitialiser les filtres"})]})]})})}export{Xe as default};
